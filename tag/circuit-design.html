<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Shortlog - Circuit Design</title>
        <link rel="stylesheet" href="http://www.sudhanshumishra.in/theme/css/main.css" />
        <link href="http://www.sudhanshumishra.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shortlog Atom Feed" />

        <meta property="og:url" content="http://www.sudhanshumishra.in" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="Shortlog" />
        <meta property="og:image" content="https://avatars3.githubusercontent.com/u/2821646?v=3&s=200" />
        <meta property="og:description" content="A blog by Sudhanshu Mishra" />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@debugger22" />
        <meta name="twitter:title" content="Shortlog" />
        <meta name="twitter:description" content="A blog by Sudhanshu Mishra" />
        <meta name="twitter:image" content="https://avatars3.githubusercontent.com/u/2821646?v=3&s=200" />
        <meta name="twitter:url" content="http://www.sudhanshumishra.in/" />
        <meta name="keywords" content="sudhanshu mishra, programming, blog" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://www.sudhanshumishra.in/">Shortlog </a></h1>
                <nav><ul>
                    <li><a href="http://www.sudhanshumishra.in/about-me">About&nbsp;me</a></li>
                    <li><a href="http://www.sudhanshumishra.in/category/android.html">Android</a></li>
                    <li><a href="http://www.sudhanshumishra.in/category/cloud-computing.html">Cloud Computing</a></li>
                    <li><a href="http://www.sudhanshumishra.in/category/gsoc.html">GSoC</a></li>
                    <li><a href="http://www.sudhanshumishra.in/category/miscellaneous.html">Miscellaneous</a></li>
                    <li><a href="http://www.sudhanshumishra.in/category/programming.html">Programming</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://www.sudhanshumishra.in/binpy-n-bit-ripple-counter">BinPy: N Bit Ripple&nbsp;Counter</a></h1>
<footer class="post-info">
        <abbr class="published" title="2014-03-13T17:36:00+05:30">
                Published: Thu 13 March 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.sudhanshumishra.in/author/sudhanshu-mishra.html">Sudhanshu Mishra</a>
        </address>
<p>In <a href="http://www.sudhanshumishra.in/category/programming.html">Programming</a>. </p>
<p>tags: <a href="http://www.sudhanshumishra.in/tag/binpy.html">BinPy</a> <a href="http://www.sudhanshumishra.in/tag/circuit-design.html">Circuit Design</a> <a href="http://www.sudhanshumishra.in/tag/electronics.html">Electronics</a> </p>
</footer><!-- /.post-info --><p><img alt="Logo" src="http://binpy.github.io/images/logo.png" /></p>
<p><a href="http://binpy.github.io">BinPy</a> is almost ready to create things. This
post focuses on building a ripple counter using&nbsp;it.</p>
<p><strong>Theory</strong></p>
<p>A ripple counter is an asynchronous counter where only the first
flip-flop is clocked by an external clock. All subsequent flip-flops are
clocked by the output of the preceding flip-flop. Asynchronous counters
are also called ripple-counters because of the way the clock pulse
ripples it way through the&nbsp;flip-flops.</p>
<p>The <span class="caps">MOD</span> of the ripple counter or asynchronous counter is 2n if n
flip-flops are used. For a 4-bit counter, the range of the count is 0000
to 1111 (24-1). A counter may count up or count down or count up and
down depending on the input control. The count sequence usually repeats
itself. When counting up, the count sequence goes from 0000, 0001, 0010,
&#8230; 1110 , 1111 , 0000, 0001, &#8230; etc. When counting down the count
sequence goes in the opposite manner: 1111, 1110, &#8230; 0010, 0001, 0000,
1111, 1110, &#8230;&nbsp;etc.</p>
<p><strong>Implementation</strong></p>
<p>The following code is using BinPy&#8217;s internal&nbsp;NBitRippleCounter.</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">BinPy.tools</span> <span class="kn">import</span> <span class="n">Clock</span>
<span class="kn">from</span> <span class="nn">BinPy.Sequential.counters</span> <span class="kn">import</span> <span class="n">NBitRippleCounter</span>
<span class="kn">from</span> <span class="nn">BinPy.Gates</span> <span class="kn">import</span> <span class="n">Connector</span>

<span class="n">toggle</span> <span class="o">=</span> <span class="n">Connector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Initialize the clock with leading edge = 1 and frequency = 1000Hz</span>
<span class="n">clock</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">(</span><span class="n">init_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">clock</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c">#Start the clock</span>
<span class="n">clk_conn</span> <span class="o">=</span> <span class="n">clock</span><span class="o">.</span><span class="n">A</span>  <span class="c">#Clock.A provides the connector of the clock</span>
<span class="n">enable</span> <span class="o">=</span> <span class="n">Connector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Initialize the counter</span>
<span class="n">counter</span> <span class="o">=</span> <span class="n">NBitRippleCounter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">clk_conn</span><span class="p">)</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;INITIAL STATE&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="n">counter</span><span class="o">.</span><span class="n">state</span><span class="p">())</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;TRIGGERING THE COUNTER SEQUENTIALLY 2^4 + 1 times&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">counter</span><span class="o">.</span><span class="n">state</span><span class="p">())</span>
    <span class="n">counter</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>
</pre></div>


<p>Following is the output of the above&nbsp;code.</p>
<div class="highlight"><pre>INITIAL STATE
[0, 0, 0, 0]
TRIGGERING THE COUNTER SEQUENTIALLY 2^4 + 1 times
[0, 0, 0, 0]
[0, 0, 0, 1]
[0, 0, 1, 0]
[0, 0, 1, 1]
[0, 1, 0, 0]
[0, 1, 0, 1]
[0, 1, 1, 0]
[0, 1, 1, 1]
[1, 0, 0, 0]
[1, 0, 0, 1]
[1, 0, 1, 0]
[1, 0, 1, 1]
[1, 1, 0, 0]
[1, 1, 0, 1]
[1, 1, 1, 0]
[1, 1, 1, 1]
</pre></div>


<p><strong>Under the&nbsp;hood</strong></p>
<p>When we are initializing the counter with specified number of bits, it
is actually creating those many T Flip Flops and connecting them in
order to get the result. The actual implementation is shown in the
following&nbsp;code.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">NBitRippleCounter</span><span class="p">(</span><span class="n">Counter</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An N-Bit Ripple Counter</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">bits</span><span class="p">,</span>
            <span class="n">clock_connector</span><span class="p">,</span>
            <span class="nb">set</span><span class="o">=</span><span class="n">Connector</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">reset</span><span class="o">=</span><span class="n">Connector</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">data</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="c"># All the output bits are initialized to this data bit</span>

        <span class="n">Counter</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bits</span><span class="p">,</span> <span class="n">clock_connector</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="n">reset</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="c"># Calling the super class constructor</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">-</span>
            <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFlipFlop</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enable</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clk</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">-</span>
                <span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outinv</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">-</span>
                <span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFlipFlop</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enable</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">[</span>
                    <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outinv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>
</pre></div>


<p>Try connecting some wires with code, it&#8217;s fun!
If you have some feedback or questions regarding this post, please add
comments.&nbsp;Cheers!</p><p>There are <a href="http://www.sudhanshumishra.in/binpy-n-bit-ripple-counter#disqus_thread">comments</a>.</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://blog.sudhanshumishra.in/">Old blog</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://www.sudhanshumishra.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/debugger22">Twitter</a></li>
                            <li><a href="https://github.com/debugger22">Github</a></li>
                            <li><a href="https://www.linkedin.com/in/sudmishra">LinkedIn</a></li>
                            <li><a href="https://news.ycombinator.com/user?id=sudmishra">Hacker News</a></li>
                            <li><a href="http://www.last.fm/user/debugger22">last.fm</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Contents &copy; 2015 Sudhanshu Mishra.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-61714694-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'newgithubpagesblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>